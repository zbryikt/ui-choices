function in$(e,t){var n=-1,r=t.length>>>0;while(++n<r)if(e===t[n])return!0;return!1}angular.module("ui.choices",[]).directive("toggle",function(e){return{restrict:"E",replace:!0,transclude:!0,template:"<button class='btn' ng-transclude></button>",scope:{model:"=ngModel",id:"="},link:function(e,t,n){if(n.ngModel)return e.model=n.active!==undefined||!!e.model,t.on("click",function(){return t[((e.model=!e.model)?"add":"remove")+"Class"]("active"),e.$apply()}),e.$watch("model",function(e){return t[(e?"add":"remove")+"Class"]("active")})}}}).directive("choices",function(e){return{restrict:"E",replace:!0,transclude:!0,scope:{model:"=ngModel",id:"=",type:"@"},template:"<div class='btn-group' ng-transclude></div>",link:function(e,t,n){var r,i;return(r=n.multi)?e.multi=e.$parent.$eval(r):n.multi===""&&(e.multi=!0),i=function(e,t,n){var r,i,s,o,u;r=[e.data,n&&e.data[n]||{}],i=r[0],n=r[1],o=[];for(s in i)o.push(s);return s=o,n.e&&((n.fb||!e.multi)&&n.on?(s.map(function(e){return i[e].on=!1}),n.on=!0):((u=s.filter(function(e){return i[e].fb})).map(function(e){return i[e].on=!1}),!s.filter(function(e){return i[e].on}).length&&u.length&&(i[u[0]].on=!0))),s.map(function(t){return i[t].m&&e.$parent.$eval(i[t].m+"="+i[t].on),i[t].e[(i[t].on?"add":"remove")+"Class"]("active")}),e.type==="array"?e.model=s.filter(function(e){return i[e].on}).map(function(e){return i[e].v}):(e.model={},s.map(function(t){return e.model[t]=!!i[t].on}))},i(e,t,null),t.on("update",function(n,r){return i(e,t,r),e.$apply()}),e.$watch("model",function(t){var n,r,i,o,u,a,f,l=[];if(!t||!t.length&&e.type==="array")return;if(e.type==="array"){n=[];for(r=0,i=t.length;r<i;++r)o=t[r],n.push(o+"");t=n}else t=function(){var e=[];for(u in t)e.push(u);return e}().filter(function(e){return t[e]});for(u in a=e.data)f=a[u],f.e[((f.on=in$(u,t))?"add":"remove")+"Class"]("active"),f.m&&l.push(e.$parent.$eval(f.m+"="+f.on));return l},!0)},controller:function(e,t){return e.btntype=t.attr("btn-type"),this.node={d:{},add:function(t,n){var r,i,s=this;return r=n.value,this.d[r]={e:t,v:r,m:n.ngModel,fb:n.fallback!==undefined,on:n.active!==undefined},(i=n.ngModel)&&e.$parent.$watch(i,function(e){return s.d[r].on=e,setTimeout(function(){return t.parent().trigger("update",s.d[r].v)},0)}),setTimeout(function(){return t.parent().trigger("update",null)},0)},tgl:function(e){return this.d[e].on=!this.d[e].on}},e.data=this.node.d,this.isMulti=function(){return e.multi},this.btntype=function(){return e.btntype},this.scope=function(){return e}}}}).directive("choice",function(e){return{restrict:"E",transclude:!0,replace:!0,require:"^choices",scope:{id:"=",d:"=ngData"},template:"<label class='btn'><span ng-transclude></span></label>",link:function(e,t,n,r){var i,s;return e.d&&(i=e.d,n.value=i.value,n.fallback=i.fallback,n.active=i.active,n.ngModel=i.ngModel,(i=e.d.btntype)!=null&&(n.btnType=i)),t.addClass((s=n.btnType)?s:(s=r.btntype())?s:"btn-primary"),r.node.add(t,n),t.on("click",function(){var e,i;return e=r.node.tgl(i=n.value),setTimeout(function(){return t.parent().trigger("update",i)},0)})}}});
